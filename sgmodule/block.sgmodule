#!name=Ad block & whitelist
#!desc=广告屏蔽和其他规则补充


[Rule]
# 强制回退 HTTP2/HTTP1.1
AND,((PROTOCOL,UDP), (DEST-PORT,443)),REJECT-NO-DROP
# 屏蔽 YouTube 的 UDP
AND,((PROTOCOL,UDP), (DOMAIN-SUFFIX,googlevideo.com)),REJECT-NO-DROP
# Safari 防跳转
DOMAIN,app-site-association.cdn-apple.com,REJECT
# Unbreak whitelist
DOMAIN,fairplay.l.qq.com,𝗗𝗜𝗥𝗘𝗖𝗧
DOMAIN,livew.l.qq.com,𝗗𝗜𝗥𝗘𝗖𝗧
DOMAIN,vd.l.qq.com,𝗗𝗜𝗥𝗘𝗖𝗧
DOMAIN,errlog.umeng.com,𝗗𝗜𝗥𝗘𝗖𝗧
DOMAIN,msg.umeng.com,𝗗𝗜𝗥𝗘𝗖𝗧
DOMAIN,msg.umengcloud.com,𝗗𝗜𝗥𝗘𝗖𝗧
DOMAIN,app.adjust.com,𝗗𝗜𝗥𝗘𝗖𝗧
DOMAIN,bdtj.tagtic.cn,𝗗𝗜𝗥𝗘𝗖𝗧
DOMAIN,dl.google.com,𝗗𝗜𝗥𝗘𝗖𝗧
DOMAIN-SUFFIX,googletraveladservices.com,𝗗𝗜𝗥𝗘𝗖𝗧

[URL Rewrite]
# baidu
^https?:\/\/fcvbjbcebos.baidu.com\/.+.mp4 - reject
^https?:\/\/cover.baidu.com\/cover\/page\/dspSwitchAds\/ - reject
^https?:\/\/baichuan.baidu.com\/rs\/adpmobile\/launch - reject
^https?:\/\/afd.baidu.com\/afd\/entry - reject
^https?:\/\/mobads\.baidu\.com\/cpro\/ui\/mads.+ - reject
(ps|sv|offnavi|newvector|ulog.imap|newloc)(.map)?.(baidu|n.shifen).com - reject
^https?:\/\/als.baidu.com\/clog\/clog - reject
^https?:\/\/update\.pan\.baidu\.com\/statistics - reject
^https?:\/\/log.+?baidu\.com - reject
^https?:\/\/www.baidu.com\/?action=static&ms=1&version=css_page_2@0.*? - reject
# 乘车码
^https:\/\/ccmsupport-sz\.tenpay\.com\/cgi-bin\/common\/ccm_page_element.cgi - reject

[Map Local]
# baidu
^https?:\/\/baichuan\.baidu\.com\/rs\/adpmobile\/launch data="https://raw.githubusercontent.com/Mubdao/Surge/main/mocks/reject-dict.json"
^https?:\/\/api\d\.tuisong\.baidu\.com data="https://raw.githubusercontent.com/Mubdao/Surge/main/mocks/reject-dict.json"
^https?:\/\/issuecdn\.baidupcs\.com\/issue\/netdisk\/guanggao\/ data="https://raw.githubusercontent.com/Mubdao/Surge/main/mocks/reject-dict.json"
^https?:\/\/[\s\S]*\.baidu\.com/.*?ad[xs]\.php data="https://raw.githubusercontent.com/Mubdao/Surge/main/mocks/reject-dict.json"
^https?:\/\/afd\.baidu\.com\/afd\/entry data="https://raw.githubusercontent.com/Mubdao/Surge/main/mocks/reject-dict.json"
^https?:\/\/fcvbjbcebos\.baidu\.com\/.+?\.mp4 data="https://raw.githubusercontent.com/Mubdao/Surge/main/mocks/reject-dict.json"
^https?:\/\/t\d{2}\.baidu\.com data="https://raw.githubusercontent.com/Mubdao/Surge/main/mocks/reject-dict.json"
^https?:\/\/sa\d\.tuisong\.baidu\.com data="https://raw.githubusercontent.com/Mubdao/Surge/main/mocks/reject-dict.json"
# CMB
^https?:\/\/webappcfg\.paas\.cmbchina\.com\/v\d\/func\/getmarketconfig data="https://raw.githubusercontent.com/Mubdao/Surge/main/mocks/reject-dict.json"

[MITM]
hostname = %APPEND% ccmsupport-sz.tenpay.com, webappcfg.paas.cmbchina.com
